{"id":"allium-992","title":"Task Graph: /Users/nixlim/Sync/PROJECTS/foundry_zero/allium/.tasks/allium-validator.task.json","status":"open","priority":0,"issue_type":"epic","owner":"riabtchuk@gmail.com","created_at":"2026-02-15T23:15:56.276441Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T23:15:56.276441Z","labels":["taskval-managed"]}
{"id":"allium-992.1","title":"Create password-auth reference example in allium.json format","description":"A complete password-auth.allium.json file exists at schemas/v1/examples/ that exercises all major Allium construct types (entities, external entities, value types, enumerations, rules with all 7 trigger types, all 8 ensures clause types, expressions, surfaces, actors, config, given, defaults, variants if applicable).\n\n## Inputs\n- **password_auth_pattern** (`string`): Valid Allium pattern from patterns library -- Source: references/patterns.md\n- **json_ast_spec** (`string`): Allium JSON AST specification -- Source: references/language-reference.md\n\n## Outputs\n- **reference_example** (`JSON file`): Valid .allium.json conforming to all schema and semantic rules -- Dest: schemas/v1/examples/password-auth.allium.json\n\n## Constraints\n- Must follow the JSON AST structure defined in language-reference.md\n- Must use the password-auth pattern as the domain basis\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"create-reference-example\",\"files_scope\":[\"schemas/v1/examples/password-auth.allium.json\"],\"effects\":\"\",\"inputs\":[{\"name\":\"password_auth_pattern\",\"type\":\"string\",\"constraints\":\"Valid Allium pattern from patterns library\",\"source\":\"references/patterns.md\"},{\"name\":\"json_ast_spec\",\"type\":\"string\",\"constraints\":\"Allium JSON AST specification\",\"source\":\"references/language-reference.md\"}],\"outputs\":[{\"name\":\"reference_example\",\"type\":\"JSON file\",\"constraints\":\"Valid .allium.json conforming to all schema and semantic rules\",\"destination\":\"schemas/v1/examples/password-auth.allium.json\"}]}}","acceptance_criteria":"- File schemas/v1/examples/password-auth.allium.json exists and is valid JSON parseable by jq\n- File contains at least one entity, one external_entity, one enumeration, one rule for each of the 7 trigger types, one surface, one actor, one config parameter, one given binding, and one default declaration\n- File contains at least one ensures clause of each of the 8 ensures clause types\n- File contains at least one expression node exercising field_access, comparison, arithmetic, and boolean logic","status":"closed","priority":0,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":480,"created_at":"2026-02-15T23:15:56.8291Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.398371Z","closed_at":"2026-02-16T00:10:09.398371Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.1","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:15:56.833516Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.10","title":"Implement state machine analysis pass for Rules 7, 8, 9","description":"A CheckStateMachines function builds a state machine graph for each entity with enum-typed status fields, detects unreachable values (RULE-07), dead-end non-terminal states (RULE-08), and undeclared status values in ensures (RULE-09).\n\n## Inputs\n- **spec** (`ast.Spec`): Parsed spec AST -- Source: internal/ast/\n- **symbols** (`SymbolTable`): Built from the same spec -- Source: internal/semantic/symbols.go\n\n## Outputs\n- **state_machine_checker** (`Go source file`): CheckStateMachines(spec, symbols) returns []Finding -- Dest: internal/semantic/statemachine.go\n- **unit_tests** (`Go test file`): Tests for each rule and valid machines -- Dest: internal/semantic/statemachine_test.go\n\n## Constraints\n- Use BFS from creation values for reachability analysis\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-state-machine-analysis\",\"files_scope\":[\"internal/semantic/statemachine.go\",\"internal/semantic/statemachine_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"spec\",\"type\":\"ast.Spec\",\"constraints\":\"Parsed spec AST\",\"source\":\"internal/ast/\"},{\"name\":\"symbols\",\"type\":\"SymbolTable\",\"constraints\":\"Built from the same spec\",\"source\":\"internal/semantic/symbols.go\"}],\"outputs\":[{\"name\":\"state_machine_checker\",\"type\":\"Go source file\",\"constraints\":\"CheckStateMachines(spec, symbols) returns []Finding\",\"destination\":\"internal/semantic/statemachine.go\"},{\"name\":\"unit_tests\",\"type\":\"Go test file\",\"constraints\":\"Tests for each rule and valid machines\",\"destination\":\"internal/semantic/statemachine_test.go\"}]}}","acceptance_criteria":"- CheckStateMachines on password-auth.allium.json returns zero findings\n- Given entity with status pending|active|done|archived where only pending-\u003eactive-\u003edone are reachable, returns finding Rule='RULE-07' mentioning 'archived'\n- Given entity with status open|blocked|done where blocked has no outgoing transition, returns finding Rule='RULE-08' mentioning 'blocked'\n- Given ensures setting status to 'cancelled' not in the enum, returns finding Rule='RULE-09' mentioning 'cancelled'\n- Given entity with no enum-typed fields, state machine analysis is skipped (zero findings for that entity)\n- go test ./internal/semantic/... -run TestStateMachine passes with 0 failures","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T23:16:01.727893Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.444521Z","closed_at":"2026-02-16T00:10:09.444521Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.10","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:16:01.729376Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.10","depends_on_id":"allium-992.7","type":"blocks","created_at":"2026-02-15T23:16:10.731811Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.11","title":"Implement expression validation pass for Rules 10, 11, 12, 13, 14","description":"A CheckExpressions function detects derived value cycles (RULE-10), out-of-scope field access (RULE-11), type mismatches in comparisons and arithmetic (RULE-12), missing lambda parameters (RULE-13), and invalid inline enum comparisons (RULE-14).\n\n## Inputs\n- **spec** (`ast.Spec`): Parsed spec AST -- Source: internal/ast/\n- **symbols** (`SymbolTable`): Built from the same spec -- Source: internal/semantic/symbols.go\n\n## Outputs\n- **expression_checker** (`Go source file`): CheckExpressions(spec, symbols) returns []Finding -- Dest: internal/semantic/expressions.go\n- **unit_tests** (`Go test file`): Tests for each rule, type pair, and valid expressions -- Dest: internal/semantic/expressions_test.go\n\n## Constraints\n- Use Tarjan's SCC algorithm for cycle detection in derived values\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-expression-validation\",\"files_scope\":[\"internal/semantic/expressions.go\",\"internal/semantic/expressions_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"spec\",\"type\":\"ast.Spec\",\"constraints\":\"Parsed spec AST\",\"source\":\"internal/ast/\"},{\"name\":\"symbols\",\"type\":\"SymbolTable\",\"constraints\":\"Built from the same spec\",\"source\":\"internal/semantic/symbols.go\"}],\"outputs\":[{\"name\":\"expression_checker\",\"type\":\"Go source file\",\"constraints\":\"CheckExpressions(spec, symbols) returns []Finding\",\"destination\":\"internal/semantic/expressions.go\"},{\"name\":\"unit_tests\",\"type\":\"Go test file\",\"constraints\":\"Tests for each rule, type pair, and valid expressions\",\"destination\":\"internal/semantic/expressions_test.go\"}]}}","acceptance_criteria":"- CheckExpressions on password-auth.allium.json returns zero findings\n- Given derived values A-\u003eB-\u003eA, returns finding Rule='RULE-10' mentioning cycle\n- Given field_access with root not in scope, returns finding Rule='RULE-11'\n- Given comparison Integer = String, returns finding Rule='RULE-12' mentioning type mismatch\n- Given arithmetic Boolean + Integer, returns finding Rule='RULE-12' mentioning non-numeric\n- Given Timestamp - Duration, returns zero RULE-12 findings (valid temporal arithmetic)\n- Given any() without lambda_param, returns finding Rule='RULE-13'\n- Given comparison between two different inline enums, returns finding Rule='RULE-14'\n- Given comparison between two named enums of the same type, returns zero RULE-14 findings\n- go test ./internal/semantic/... -run TestExpression passes with 0 failures","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":480,"created_at":"2026-02-15T23:16:02.236362Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.451052Z","closed_at":"2026-02-16T00:10:09.451052Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.11","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:16:02.237744Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.11","depends_on_id":"allium-992.7","type":"blocks","created_at":"2026-02-15T23:16:11.120633Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.12","title":"Implement sum type enforcement pass for Rules 16, 17, 18, 19","description":"A CheckSumTypes function verifies discriminator-variant consistency (RULE-16, RULE-17), guarded variant field access (RULE-18), and variant name creation requirements (RULE-19).\n\n## Inputs\n- **spec** (`ast.Spec`): Parsed spec AST -- Source: internal/ast/\n- **symbols** (`SymbolTable`): Built from the same spec -- Source: internal/semantic/symbols.go\n\n## Outputs\n- **sum_type_checker** (`Go source file`): CheckSumTypes(spec, symbols) returns []Finding -- Dest: internal/semantic/sumtypes.go\n- **unit_tests** (`Go test file`): Tests for each rule and valid sum types -- Dest: internal/semantic/sumtypes_test.go\n\n## Constraints\n- Type guard detection must handle requires clauses and if-branch discriminator checks\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-sum-type-enforcement\",\"files_scope\":[\"internal/semantic/sumtypes.go\",\"internal/semantic/sumtypes_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"spec\",\"type\":\"ast.Spec\",\"constraints\":\"Parsed spec AST\",\"source\":\"internal/ast/\"},{\"name\":\"symbols\",\"type\":\"SymbolTable\",\"constraints\":\"Built from the same spec\",\"source\":\"internal/semantic/symbols.go\"}],\"outputs\":[{\"name\":\"sum_type_checker\",\"type\":\"Go source file\",\"constraints\":\"CheckSumTypes(spec, symbols) returns []Finding\",\"destination\":\"internal/semantic/sumtypes.go\"},{\"name\":\"unit_tests\",\"type\":\"Go test file\",\"constraints\":\"Tests for each rule and valid sum types\",\"destination\":\"internal/semantic/sumtypes_test.go\"}]}}","acceptance_criteria":"- Given discriminator Branch|Leaf but only variant Branch declared, returns finding Rule='RULE-16' mentioning 'Leaf'\n- Given variant Stem:Node but Node discriminator has no Stem, returns finding Rule='RULE-17' mentioning 'Stem'\n- Given access to variant field without type guard, returns finding Rule='RULE-18'\n- Given access to variant field inside type guard (requires clause checking discriminator), returns zero RULE-18 findings\n- Given entity creation using base name when discriminator exists, returns finding Rule='RULE-19'\n- go test ./internal/semantic/... -run TestSumType passes with 0 failures","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T23:16:02.758619Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.45626Z","closed_at":"2026-02-16T00:10:09.45626Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.12","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:16:02.759727Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.12","depends_on_id":"allium-992.7","type":"blocks","created_at":"2026-02-15T23:16:11.497931Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.13","title":"Implement surface semantic validation pass for Rules 29, 32, 33, 34","description":"A CheckSurfaces function verifies that all exposes paths are reachable (RULE-29), all bindings are used (RULE-32), when conditions reference valid fields (RULE-33), and for iterations target collections (RULE-34).\n\n## Inputs\n- **spec** (`ast.Spec`): Parsed spec AST -- Source: internal/ast/\n- **symbols** (`SymbolTable`): Built from the same spec -- Source: internal/semantic/symbols.go\n\n## Outputs\n- **surface_checker** (`Go source file`): CheckSurfaces(spec, symbols) returns []Finding -- Dest: internal/semantic/surfaces.go\n- **unit_tests** (`Go test file`): Tests for each rule and valid surfaces -- Dest: internal/semantic/surfaces_test.go\n\n## Constraints\n- Path reachability must traverse relationships and entity fields from binding roots\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-surface-validation\",\"files_scope\":[\"internal/semantic/surfaces.go\",\"internal/semantic/surfaces_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"spec\",\"type\":\"ast.Spec\",\"constraints\":\"Parsed spec AST\",\"source\":\"internal/ast/\"},{\"name\":\"symbols\",\"type\":\"SymbolTable\",\"constraints\":\"Built from the same spec\",\"source\":\"internal/semantic/symbols.go\"}],\"outputs\":[{\"name\":\"surface_checker\",\"type\":\"Go source file\",\"constraints\":\"CheckSurfaces(spec, symbols) returns []Finding\",\"destination\":\"internal/semantic/surfaces.go\"},{\"name\":\"unit_tests\",\"type\":\"Go test file\",\"constraints\":\"Tests for each rule and valid surfaces\",\"destination\":\"internal/semantic/surfaces_test.go\"}]}}","acceptance_criteria":"- CheckSurfaces on password-auth.allium.json returns zero findings\n- Given exposes path not reachable from facing or context, returns finding Rule='RULE-29'\n- Given facing binding never referenced in surface body, returns finding Rule='RULE-32'\n- Given when condition referencing field not reachable from bindings, returns finding Rule='RULE-33'\n- Given for iteration over a String-typed field, returns finding Rule='RULE-34'\n- go test ./internal/semantic/... -run TestSurface passes with 0 failures","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T23:16:03.268148Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.460963Z","closed_at":"2026-02-16T00:10:09.460963Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.13","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:16:03.269319Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.13","depends_on_id":"allium-992.7","type":"blocks","created_at":"2026-02-15T23:16:11.871655Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.14","title":"Implement warning detection pass for WARN-01 through WARN-19","description":"A CheckWarnings function detects all 19 warning conditions and returns them as warning-severity findings, each with a unique WARN-XX ID.\n\n## Inputs\n- **spec** (`ast.Spec`): Parsed spec AST -- Source: internal/ast/\n- **symbols** (`SymbolTable`): Built from the same spec -- Source: internal/semantic/symbols.go\n\n## Outputs\n- **warning_checker** (`Go source file`): CheckWarnings(spec, symbols) returns []Finding with Severity=SeverityWarning -- Dest: internal/semantic/warnings.go\n- **unit_tests** (`Go test file`): One test per warning ID -- Dest: internal/semantic/warnings_test.go\n\n## Constraints\n- Warnings must never have Severity=SeverityError\n- Each warning must include the WARN-XX ID in the Rule field\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-warning-detection\",\"files_scope\":[\"internal/semantic/warnings.go\",\"internal/semantic/warnings_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"spec\",\"type\":\"ast.Spec\",\"constraints\":\"Parsed spec AST\",\"source\":\"internal/ast/\"},{\"name\":\"symbols\",\"type\":\"SymbolTable\",\"constraints\":\"Built from the same spec\",\"source\":\"internal/semantic/symbols.go\"}],\"outputs\":[{\"name\":\"warning_checker\",\"type\":\"Go source file\",\"constraints\":\"CheckWarnings(spec, symbols) returns []Finding with Severity=SeverityWarning\",\"destination\":\"internal/semantic/warnings.go\"},{\"name\":\"unit_tests\",\"type\":\"Go test file\",\"constraints\":\"One test per warning ID\",\"destination\":\"internal/semantic/warnings_test.go\"}]}}","acceptance_criteria":"- CheckWarnings on a clean spec returns zero findings\n- Given external entity not in any use declaration, returns WARN-01\n- Given non-empty open_questions, returns WARN-02\n- Given deferred spec with null location_hint, returns WARN-03\n- Given entity never referenced by any rule or surface, returns WARN-04\n- Given rule with contradictory requires (status=A and status=B), returns WARN-05\n- Given temporal trigger without re-firing guard, returns WARN-06\n- Given surface exposes field used by no rule, returns WARN-07\n- Given provides with always-false when condition, returns WARN-08\n- Given actor not referenced in any surface facing, returns WARN-09\n- Given child creation without duplicate guard, returns WARN-10\n- Given provides when condition weaker than rule requires, returns WARN-11\n- Given overlapping requires on same trigger, returns WARN-12\n- Given derived value referencing out-of-entity field, returns WARN-13\n- Given actor identified_by always true or false, returns WARN-14\n- Given all-conditional ensures with empty path, returns WARN-15\n- Given temporal trigger on optional field, returns WARN-16\n- Given raw entity type in facing when actors exist, returns WARN-17\n- Given transitions_to on creation value, returns WARN-18\n- Given multiple fields with identical inline enum literals, returns WARN-19\n- All returned findings have Severity=SeverityWarning\n- go test ./internal/semantic/... -run TestWarn passes with 0 failures","status":"closed","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":480,"created_at":"2026-02-15T23:16:03.801161Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.464847Z","closed_at":"2026-02-16T00:10:09.464847Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.14","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:16:03.802345Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.14","depends_on_id":"allium-992.7","type":"blocks","created_at":"2026-02-15T23:16:12.262905Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.14","depends_on_id":"allium-992.8","type":"blocks","created_at":"2026-02-15T23:16:12.633491Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.15","title":"Implement checker pipeline that orchestrates schema and semantic passes","description":"A Checker in internal/checker/ orchestrates all validation passes (schema validation, then 7 semantic passes) in order, respects --schema-only and --rules flags, and produces a complete Report.\n\n## Inputs\n- **file_path** (`string`): Path to .allium.json file -- Source: CLI argument\n- **options** (`CheckOptions`): SchemaOnly bool, RuleFilter []int -- Source: CLI flags\n\n## Outputs\n- **checker** (`Go source files`): Checker.Check(path, opts) returns *Report -- Dest: internal/checker/\n- **integration_tests** (`Go test file`): Tests full pipeline on reference example -- Dest: internal/checker/checker_test.go\n\n## Constraints\n- Schema validation must run before semantic passes\n- Semantic passes must not run if schema validation fails\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-checker-pipeline\",\"files_scope\":[\"internal/checker/*.go\",\"internal/checker/*_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"file_path\",\"type\":\"string\",\"constraints\":\"Path to .allium.json file\",\"source\":\"CLI argument\"},{\"name\":\"options\",\"type\":\"CheckOptions\",\"constraints\":\"SchemaOnly bool, RuleFilter []int\",\"source\":\"CLI flags\"}],\"outputs\":[{\"name\":\"checker\",\"type\":\"Go source files\",\"constraints\":\"Checker.Check(path, opts) returns *Report\",\"destination\":\"internal/checker/\"},{\"name\":\"integration_tests\",\"type\":\"Go test file\",\"constraints\":\"Tests full pipeline on reference example\",\"destination\":\"internal/checker/checker_test.go\"}]}}","acceptance_criteria":"- Checker.Check on password-auth.allium.json with default options returns a Report with 0 errors and 0 warnings\n- Checker.Check with SchemaOnly=true skips all semantic passes (only schema errors reported)\n- Checker.Check with RuleFilter=[7,8,9] only runs state machine rules plus schema validation\n- Checker.Check on a file with schema errors does not run semantic passes\n- Checker.Check on a nonexistent file returns a Report with an input error\n- go test ./internal/checker/... passes with 0 failures","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T23:16:04.308695Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.469589Z","closed_at":"2026-02-16T00:10:09.469589Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.15","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:16:04.309838Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.15","depends_on_id":"allium-992.6","type":"blocks","created_at":"2026-02-15T23:16:13.00439Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.15","depends_on_id":"allium-992.8","type":"blocks","created_at":"2026-02-15T23:16:13.394488Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.15","depends_on_id":"allium-992.9","type":"blocks","created_at":"2026-02-15T23:16:13.766188Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.15","depends_on_id":"allium-992.10","type":"blocks","created_at":"2026-02-15T23:16:14.131997Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.15","depends_on_id":"allium-992.11","type":"blocks","created_at":"2026-02-15T23:16:14.49007Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.15","depends_on_id":"allium-992.12","type":"blocks","created_at":"2026-02-15T23:16:14.858949Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.15","depends_on_id":"allium-992.13","type":"blocks","created_at":"2026-02-15T23:16:15.225473Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.15","depends_on_id":"allium-992.14","type":"blocks","created_at":"2026-02-15T23:16:15.601291Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.15","depends_on_id":"allium-992.5","type":"blocks","created_at":"2026-02-15T23:16:15.967084Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.16","title":"Implement allium-check CLI binary with flags and exit codes","description":"An allium-check binary at cmd/allium-check/main.go accepts file paths and flags (--format, --quiet, --strict, --schema-only, --rules, --version), returns correct exit codes (0/1/2), and outputs formatted validation results.\n\n## Inputs\n- **file_paths** (`list\u003cstring\u003e`): One or more .allium.json paths -- Source: CLI positional arguments\n- **flags** (`CLI flags`): --format text|json, --quiet, --strict, --schema-only, --rules N-M, --version -- Source: CLI flags\n\n## Outputs\n- **cli_binary** (`Go source file`): Single main.go with flag parsing and orchestration -- Dest: cmd/allium-check/main.go\n- **integration_tests** (`Go test file`): Tests for exit codes, flag combinations, multi-file -- Dest: cmd/allium-check/main_test.go\n\n## Constraints\n- Use only standard library flag package\n- Exit codes: 0=clean, 1=validation errors, 2=input/parse errors\n- Single static binary with no runtime dependencies\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-cli-binary\",\"files_scope\":[\"cmd/allium-check/main.go\",\"cmd/allium-check/main_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"file_paths\",\"type\":\"list\\u003cstring\\u003e\",\"constraints\":\"One or more .allium.json paths\",\"source\":\"CLI positional arguments\"},{\"name\":\"flags\",\"type\":\"CLI flags\",\"constraints\":\"--format text|json, --quiet, --strict, --schema-only, --rules N-M, --version\",\"source\":\"CLI flags\"}],\"outputs\":[{\"name\":\"cli_binary\",\"type\":\"Go source file\",\"constraints\":\"Single main.go with flag parsing and orchestration\",\"destination\":\"cmd/allium-check/main.go\"},{\"name\":\"integration_tests\",\"type\":\"Go test file\",\"constraints\":\"Tests for exit codes, flag combinations, multi-file\",\"destination\":\"cmd/allium-check/main_test.go\"}]}}","acceptance_criteria":"- go build -o bin/allium-check ./cmd/allium-check/ produces a binary without errors\n- bin/allium-check password-auth.allium.json exits with code 0 and output contains '0 errors'\n- bin/allium-check missing.json exits with code 2 and output contains 'file not found' or 'no such file'\n- bin/allium-check --format json valid.allium.json produces valid JSON output with keys file, schema_valid, errors, warnings, summary\n- bin/allium-check --quiet with warnings present exits 0 with warnings not shown\n- bin/allium-check --strict with warnings present exits 1\n- bin/allium-check --schema-only with semantic errors reports only schema results\n- bin/allium-check --version prints a version string and exits 0\n- bin/allium-check valid.allium.json broken.allium.json reports results for each file separately\n- go test ./cmd/allium-check/... passes with 0 failures","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T23:16:04.820614Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.474913Z","closed_at":"2026-02-16T00:10:09.474913Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.16","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:16:04.821844Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.16","depends_on_id":"allium-992.15","type":"blocks","created_at":"2026-02-15T23:16:16.346092Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.17","title":"Create intentionally broken variants of the reference example for E2E testing","description":"Five broken variants of password-auth.allium.json exist in schemas/v1/examples/broken/, each introducing exactly one specific violation that triggers the corresponding rule error.\n\n## Inputs\n- **reference_example** (`JSON file`): Valid password-auth.allium.json -- Source: schemas/v1/examples/password-auth.allium.json\n\n## Outputs\n- **broken_variants** (`list\u003cJSON file\u003e`): 5 files, each with exactly one violation -- Dest: schemas/v1/examples/broken/\n\n## Constraints\n- Each variant must differ from the reference by exactly one change\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"create-broken-example-variants\",\"files_scope\":[\"schemas/v1/examples/broken/*.allium.json\"],\"effects\":\"\",\"inputs\":[{\"name\":\"reference_example\",\"type\":\"JSON file\",\"constraints\":\"Valid password-auth.allium.json\",\"source\":\"schemas/v1/examples/password-auth.allium.json\"}],\"outputs\":[{\"name\":\"broken_variants\",\"type\":\"list\\u003cJSON file\\u003e\",\"constraints\":\"5 files, each with exactly one violation\",\"destination\":\"schemas/v1/examples/broken/\"}]}}","acceptance_criteria":"- broken/undeclared-ref.allium.json has an entity_ref to undeclared 'FooBar' and allium-check reports RULE-01\n- broken/duplicate-config.allium.json has two config parameters with the same name and allium-check reports RULE-26\n- broken/unreachable-state.allium.json has an unreachable status value and allium-check reports RULE-07\n- broken/circular-derived.allium.json has circular derived value dependencies and allium-check reports RULE-10\n- broken/unguarded-variant.allium.json has unguarded variant field access and allium-check reports RULE-18\n- Each broken variant produces exactly the expected rule error when validated","status":"closed","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T23:16:05.315051Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.47876Z","closed_at":"2026-02-16T00:10:09.47876Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.17","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:16:05.316412Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.17","depends_on_id":"allium-992.16","type":"blocks","created_at":"2026-02-15T23:16:16.713362Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.18","title":"Implement validate skill definition for LLM-driven validation workflow","description":"A validate skill definition file exists in skills/validate/ that converts .allium to .allium.json, invokes allium-check --format json, presents errors with human-readable explanations and suggested fixes, and runs LLM guidance checks for naming quality and spec completeness.\n\n## Inputs\n- **allium_file** (`string`): Path to .allium or .allium.json file -- Source: User invocation\n- **allium_check_binary** (`binary`): Must be in PATH or buildable -- Source: cmd/allium-check/\n\n## Outputs\n- **skill_definition** (`Markdown skill file`): Follows skill definition format from SKILL.md -- Dest: skills/validate/SKILL.md\n\n## Constraints\n- Must follow the skill definition format used by existing skills in skills/\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-validate-skill\",\"files_scope\":[\"skills/validate/SKILL.md\"],\"effects\":\"\",\"inputs\":[{\"name\":\"allium_file\",\"type\":\"string\",\"constraints\":\"Path to .allium or .allium.json file\",\"source\":\"User invocation\"},{\"name\":\"allium_check_binary\",\"type\":\"binary\",\"constraints\":\"Must be in PATH or buildable\",\"source\":\"cmd/allium-check/\"}],\"outputs\":[{\"name\":\"skill_definition\",\"type\":\"Markdown skill file\",\"constraints\":\"Follows skill definition format from SKILL.md\",\"destination\":\"skills/validate/SKILL.md\"}]}}","acceptance_criteria":"- skills/validate/SKILL.md exists and contains step-by-step instructions for the validate workflow\n- Skill instructions include a step to convert .allium to .allium.json when input is .allium format\n- Skill instructions include invoking allium-check --format json\n- Skill instructions include interpreting each error with a human-readable explanation and suggested fix\n- Skill instructions include LLM guidance checks for vague rule names (e.g., DoThing, HandleStuff)\n- Skill instructions include LLM guidance checks for missing common patterns (e.g., temporal rules for time-sensitive entities)\n- Skill instructions include error handling for missing allium-check binary with build instructions","status":"closed","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T23:16:05.821141Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.494902Z","closed_at":"2026-02-16T00:10:09.494902Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.18","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:16:05.82237Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.18","depends_on_id":"allium-992.16","type":"blocks","created_at":"2026-02-15T23:16:17.074214Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.19","title":"Write validation rules documentation with examples and fixes","description":"VALIDATION-RULES.md maps every rule (RULE-01 through RULE-35) and warning (WARN-01 through WARN-19) to its ID, description, severity, and implementation, plus 7 rule group documents and a warnings.md each with example violations and fixes.\n\n## Inputs\n- **spec** (`string`): Allium validator spec with all rule definitions -- Source: specs/allium-validator-spec.md\n- **language_reference** (`string`): Allium language reference -- Source: references/language-reference.md\n\n## Outputs\n- **rules_index** (`Markdown file`): Complete mapping of all rules and warnings -- Dest: docs/VALIDATION-RULES.md\n- **rule_group_docs** (`list\u003cMarkdown file\u003e`): 7 group files with examples -- Dest: docs/rules/\n- **warnings_doc** (`Markdown file`): All 19 warnings with triggers and resolutions -- Dest: docs/warnings.md\n\n## Constraints\n- Rule descriptions must be consistent with the language-reference.md specification\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"write-validation-documentation\",\"files_scope\":[\"docs/VALIDATION-RULES.md\",\"docs/rules/*.md\",\"docs/warnings.md\"],\"effects\":\"\",\"inputs\":[{\"name\":\"spec\",\"type\":\"string\",\"constraints\":\"Allium validator spec with all rule definitions\",\"source\":\"specs/allium-validator-spec.md\"},{\"name\":\"language_reference\",\"type\":\"string\",\"constraints\":\"Allium language reference\",\"source\":\"references/language-reference.md\"}],\"outputs\":[{\"name\":\"rules_index\",\"type\":\"Markdown file\",\"constraints\":\"Complete mapping of all rules and warnings\",\"destination\":\"docs/VALIDATION-RULES.md\"},{\"name\":\"rule_group_docs\",\"type\":\"list\\u003cMarkdown file\\u003e\",\"constraints\":\"7 group files with examples\",\"destination\":\"docs/rules/\"},{\"name\":\"warnings_doc\",\"type\":\"Markdown file\",\"constraints\":\"All 19 warnings with triggers and resolutions\",\"destination\":\"docs/warnings.md\"}]}}","acceptance_criteria":"- docs/VALIDATION-RULES.md contains entries for RULE-01 through RULE-35, each with ID, description, severity, and implementation mapping\n- docs/VALIDATION-RULES.md contains entries for WARN-01 through WARN-19, each with ID and description\n- docs/rules/ contains 7 files: structural.md, state-machine.md, expression.md, sum-type.md, given.md, config.md, surface.md\n- Each rule group document contains an explanation, an example violation, and an example fix for each rule in the group\n- docs/warnings.md contains 19 entries, each with ID, description, example trigger, and suggested resolution","status":"closed","priority":3,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":480,"created_at":"2026-02-15T23:16:06.340592Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.499762Z","closed_at":"2026-02-16T00:10:09.499762Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.19","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:16:06.341728Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.19","depends_on_id":"allium-992.16","type":"blocks","created_at":"2026-02-15T23:16:17.435206Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.2","title":"Implement validation error and warning type definitions","description":"Shared error and warning types exist in internal/report/ that represent validation findings with rule ID, severity, message, and location, usable by all validation passes and output formatters.\n\n## Inputs\n- **rule_ids** (`list\u003cstring\u003e`): RULE-01 through RULE-35 and WARN-01 through WARN-19 -- Source: specs/allium-validator-spec.md\n\n## Outputs\n- **report_types** (`Go source files`): Finding, Report, Severity, Location types -- Dest: internal/report/\n\n## Constraints\n- No external dependencies; standard library only\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-error-types\",\"files_scope\":[\"internal/report/*.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"rule_ids\",\"type\":\"list\\u003cstring\\u003e\",\"constraints\":\"RULE-01 through RULE-35 and WARN-01 through WARN-19\",\"source\":\"specs/allium-validator-spec.md\"}],\"outputs\":[{\"name\":\"report_types\",\"type\":\"Go source files\",\"constraints\":\"Finding, Report, Severity, Location types\",\"destination\":\"internal/report/\"}]}}","acceptance_criteria":"- go build ./internal/report/... compiles without errors\n- Finding struct has fields: Rule (string), Severity (enum: error/warning), Message (string), Location (struct with File, Path, Line)\n- Report struct has fields: File (string), SchemaValid (bool), Errors ([]Finding), Warnings ([]Finding), Summary (struct with ErrorCount, WarningCount int)\n- Severity type has exactly two values: SeverityError and SeverityWarning","status":"closed","priority":0,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":15,"created_at":"2026-02-15T23:15:57.369886Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.410413Z","closed_at":"2026-02-16T00:10:09.410413Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.2","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:15:57.371446Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.20","title":"Integrate validation into distill and elicit skill workflows","description":"The distill skill adds a Step 8 that generates .allium.json and runs validation (fixing errors before presenting output), and the elicit skill uses validation errors as conversation prompts during Phase 4 refinement.\n\n## Inputs\n- **distill_skill** (`Markdown file`): Existing skill definition -- Source: skills/distill/\n- **elicit_skill** (`Markdown file`): Existing skill definition -- Source: skills/elicit/\n- **root_skill** (`Markdown file`): Routing table -- Source: SKILL.md\n\n## Outputs\n- **updated_distill** (`Markdown file`): Adds Step 8 for validation -- Dest: skills/distill/SKILL.md\n- **updated_elicit** (`Markdown file`): Adds validation in Phase 4 -- Dest: skills/elicit/SKILL.md\n- **updated_routing** (`Markdown file`): Adds validate skill to routing table -- Dest: SKILL.md\n\n## Constraints\n- Must not break existing skill steps; only add new steps/sections\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"integrate-distill-elicit-skills\",\"files_scope\":[\"skills/distill/SKILL.md\",\"skills/elicit/SKILL.md\",\"SKILL.md\"],\"effects\":\"\",\"inputs\":[{\"name\":\"distill_skill\",\"type\":\"Markdown file\",\"constraints\":\"Existing skill definition\",\"source\":\"skills/distill/\"},{\"name\":\"elicit_skill\",\"type\":\"Markdown file\",\"constraints\":\"Existing skill definition\",\"source\":\"skills/elicit/\"},{\"name\":\"root_skill\",\"type\":\"Markdown file\",\"constraints\":\"Routing table\",\"source\":\"SKILL.md\"}],\"outputs\":[{\"name\":\"updated_distill\",\"type\":\"Markdown file\",\"constraints\":\"Adds Step 8 for validation\",\"destination\":\"skills/distill/SKILL.md\"},{\"name\":\"updated_elicit\",\"type\":\"Markdown file\",\"constraints\":\"Adds validation in Phase 4\",\"destination\":\"skills/elicit/SKILL.md\"},{\"name\":\"updated_routing\",\"type\":\"Markdown file\",\"constraints\":\"Adds validate skill to routing table\",\"destination\":\"SKILL.md\"}]}}","acceptance_criteria":"- skills/distill/SKILL.md contains a Step 8 that generates .allium.json and invokes allium-check\n- skills/distill/SKILL.md Step 8 specifies fixing errors before presenting output to the user\n- skills/elicit/SKILL.md references validation during Phase 4 refinement\n- skills/elicit/SKILL.md specifies using validation errors as conversation prompts\n- SKILL.md routing table contains an entry for the validate skill\n- Existing steps in distill and elicit skills remain unchanged","status":"closed","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T23:16:06.847202Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.503382Z","closed_at":"2026-02-16T00:10:09.503382Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.20","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:16:06.856863Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.20","depends_on_id":"allium-992.18","type":"blocks","created_at":"2026-02-15T23:16:17.802383Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.3","title":"Define the 14 JSON Schema definition files for Allium validation","description":"Fourteen JSON Schema files exist under schemas/v1/ that structurally validate .allium.json documents, enforcing Rules 2, 4, 5, 15, 20, 21, and 25, plus PascalCase and snake_case naming patterns.\n\n## Inputs\n- **language_reference** (`string`): Allium language specification -- Source: references/language-reference.md\n- **reference_example** (`JSON file`): Must be valid against the schemas -- Source: schemas/v1/examples/password-auth.allium.json\n\n## Outputs\n- **root_schema** (`JSON Schema file`): Draft 2020-12, composes all definition files via $ref -- Dest: schemas/v1/allium-spec.json\n- **definition_files** (`list\u003cJSON Schema file\u003e`): 14 files: common, field-types, expressions, entities, enumerations, rules, surfaces, actors, config, defaults, given, use-declarations, deferred, open-questions -- Dest: schemas/v1/definitions/\n\n## Constraints\n- Use JSON Schema draft 2020-12\n- All $ref paths must be relative and composable\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"define-json-schemas\",\"files_scope\":[\"schemas/v1/allium-spec.json\",\"schemas/v1/definitions/*.json\"],\"effects\":\"\",\"inputs\":[{\"name\":\"language_reference\",\"type\":\"string\",\"constraints\":\"Allium language specification\",\"source\":\"references/language-reference.md\"},{\"name\":\"reference_example\",\"type\":\"JSON file\",\"constraints\":\"Must be valid against the schemas\",\"source\":\"schemas/v1/examples/password-auth.allium.json\"}],\"outputs\":[{\"name\":\"root_schema\",\"type\":\"JSON Schema file\",\"constraints\":\"Draft 2020-12, composes all definition files via $ref\",\"destination\":\"schemas/v1/allium-spec.json\"},{\"name\":\"definition_files\",\"type\":\"list\\u003cJSON Schema file\\u003e\",\"constraints\":\"14 files: common, field-types, expressions, entities, enumerations, rules, surfaces, actors, config, defaults, given, use-declarations, deferred, open-questions\",\"destination\":\"schemas/v1/definitions/\"}]}}","acceptance_criteria":"- Root schema schemas/v1/allium-spec.json exists and references all 14 definition files\n- Each of the 14 definition files (common.json, field-types.json, expressions.json, entities.json, enumerations.json, rules.json, surfaces.json, actors.json, config.json, defaults.json, given.json, use-declarations.json, deferred.json, open-questions.json) exists in schemas/v1/definitions/\n- Entity name fields enforce PascalCase pattern ^[A-Z][a-zA-Z0-9]*$\n- Field name properties enforce snake_case pattern ^[a-z][a-z0-9_]*$\n- rules.json requires trigger + non-empty ensures (minItems: 1) per Rule 4\n- rules.json restricts trigger kind to exactly 7 valid values per Rule 5\n- entities.json requires fields to have name + type per Rule 2\n- Variant names enforce PascalCase per Rule 15\n- config.json requires name, type, and default_value per Rule 25\n- The reference example password-auth.allium.json validates against the root schema without errors","status":"closed","priority":0,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":480,"created_at":"2026-02-15T23:15:57.934119Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.414208Z","closed_at":"2026-02-16T00:10:09.414208Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.3","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:15:57.936622Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.3","depends_on_id":"allium-992.1","type":"blocks","created_at":"2026-02-15T23:16:07.227531Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.4","title":"Implement Go AST type definitions for allium.json deserialization","description":"Go struct types exist in internal/ast/ that represent every construct in a .allium.json file, and a LoadSpec function deserializes valid JSON into these structs.\n\n## Inputs\n- **json_ast_spec** (`string`): Allium JSON AST specification -- Source: references/language-reference.md\n- **reference_example** (`JSON file`): Valid .allium.json -- Source: schemas/v1/examples/password-auth.allium.json\n\n## Outputs\n- **ast_types** (`Go source files`): Exported structs with json tags matching the JSON AST -- Dest: internal/ast/\n- **loader** (`Go source file`): LoadSpec(path) returns (*Spec, error) -- Dest: internal/ast/loader.go\n\n## Constraints\n- Use standard library encoding/json only\n- All struct fields must have json tags\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-go-ast-types\",\"files_scope\":[\"internal/ast/*.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"json_ast_spec\",\"type\":\"string\",\"constraints\":\"Allium JSON AST specification\",\"source\":\"references/language-reference.md\"},{\"name\":\"reference_example\",\"type\":\"JSON file\",\"constraints\":\"Valid .allium.json\",\"source\":\"schemas/v1/examples/password-auth.allium.json\"}],\"outputs\":[{\"name\":\"ast_types\",\"type\":\"Go source files\",\"constraints\":\"Exported structs with json tags matching the JSON AST\",\"destination\":\"internal/ast/\"},{\"name\":\"loader\",\"type\":\"Go source file\",\"constraints\":\"LoadSpec(path) returns (*Spec, error)\",\"destination\":\"internal/ast/loader.go\"}]}}","acceptance_criteria":"- go build ./internal/ast/... compiles without errors\n- LoadSpec('schemas/v1/examples/password-auth.allium.json') returns a non-nil *Spec and nil error\n- The returned Spec struct has non-empty Entities, Rules, and Version fields\n- LoadSpec on a nonexistent file returns a nil Spec and non-nil error containing 'file not found' or 'no such file'\n- LoadSpec on invalid JSON returns a nil Spec and non-nil error containing 'parse' or 'unmarshal'","status":"closed","priority":0,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":480,"created_at":"2026-02-15T23:15:58.509451Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.417985Z","closed_at":"2026-02-16T00:10:09.417985Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.4","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:15:58.510671Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.4","depends_on_id":"allium-992.1","type":"blocks","created_at":"2026-02-15T23:16:07.61118Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.5","title":"Implement text and JSON output formatters for validation reports","description":"Text and JSON formatters exist in internal/report/ that serialize a Report into human-readable text (one issue per line) or structured JSON (with file, schema_valid, errors, warnings, summary keys).\n\n## Inputs\n- **report** (`report.Report`): Populated report from validation passes -- Source: internal/report/\n\n## Outputs\n- **text_formatter** (`Go source file`): FormatText(report) returns string -- Dest: internal/report/format_text.go\n- **json_formatter** (`Go source file`): FormatJSON(report) returns ([]byte, error) -- Dest: internal/report/format_json.go\n- **unit_tests** (`Go test files`): Tests for both formats -- Dest: internal/report/*_test.go\n\n## Constraints\n- JSON output must be parseable by jq without errors\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-output-formatters\",\"files_scope\":[\"internal/report/format_text.go\",\"internal/report/format_json.go\",\"internal/report/*_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"report\",\"type\":\"report.Report\",\"constraints\":\"Populated report from validation passes\",\"source\":\"internal/report/\"}],\"outputs\":[{\"name\":\"text_formatter\",\"type\":\"Go source file\",\"constraints\":\"FormatText(report) returns string\",\"destination\":\"internal/report/format_text.go\"},{\"name\":\"json_formatter\",\"type\":\"Go source file\",\"constraints\":\"FormatJSON(report) returns ([]byte, error)\",\"destination\":\"internal/report/format_json.go\"},{\"name\":\"unit_tests\",\"type\":\"Go test files\",\"constraints\":\"Tests for both formats\",\"destination\":\"internal/report/*_test.go\"}]}}","acceptance_criteria":"- FormatText on a report with 0 errors and 0 warnings produces output containing '0 errors' and '0 warnings'\n- FormatText on a report with errors produces one line per error containing rule ID, severity, and message\n- FormatJSON on any report produces valid JSON parseable by encoding/json.Unmarshal\n- FormatJSON output contains keys: 'file', 'schema_valid', 'errors', 'warnings', 'summary'\n- FormatJSON errors array entries each contain 'rule', 'severity', 'message', 'location'\n- go test ./internal/report/... passes with 0 failures","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T23:15:59.042912Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.421936Z","closed_at":"2026-02-16T00:10:09.421936Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.5","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:15:59.044046Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.5","depends_on_id":"allium-992.2","type":"blocks","created_at":"2026-02-15T23:16:08.003223Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.6","title":"Implement schema validation engine with embedded JSON Schema files","description":"A SchemaValidator in internal/schema/ embeds all 14 JSON Schema files via go:embed and validates .allium.json documents against the root schema, returning structured error reports.\n\n## Inputs\n- **schema_files** (`list\u003cJSON Schema file\u003e`): 14 definition files + root schema -- Source: schemas/v1/\n- **reference_example** (`JSON file`): Must pass validation -- Source: schemas/v1/examples/password-auth.allium.json\n\n## Outputs\n- **schema_validator** (`Go source files`): SchemaValidator.Validate(doc) returns []SchemaError -- Dest: internal/schema/\n- **unit_tests** (`Go test files`): Tests for valid docs, missing fields, rule enforcement, naming patterns -- Dest: internal/schema/*_test.go\n\n## Constraints\n- Use github.com/santhosh-tekuri/jsonschema/v6 library\n- Embed schemas via go:embed directive\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-schema-validation-engine\",\"files_scope\":[\"internal/schema/*.go\",\"internal/schema/*_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"schema_files\",\"type\":\"list\\u003cJSON Schema file\\u003e\",\"constraints\":\"14 definition files + root schema\",\"source\":\"schemas/v1/\"},{\"name\":\"reference_example\",\"type\":\"JSON file\",\"constraints\":\"Must pass validation\",\"source\":\"schemas/v1/examples/password-auth.allium.json\"}],\"outputs\":[{\"name\":\"schema_validator\",\"type\":\"Go source files\",\"constraints\":\"SchemaValidator.Validate(doc) returns []SchemaError\",\"destination\":\"internal/schema/\"},{\"name\":\"unit_tests\",\"type\":\"Go test files\",\"constraints\":\"Tests for valid docs, missing fields, rule enforcement, naming patterns\",\"destination\":\"internal/schema/*_test.go\"}]}}","acceptance_criteria":"- go build ./internal/schema/... compiles without errors\n- SchemaValidator.Validate on password-auth.allium.json returns zero errors\n- SchemaValidator.Validate on a document missing 'version' returns at least one error mentioning 'version'\n- SchemaValidator.Validate on an entity field missing 'type' returns an error (Rule 2 enforcement)\n- SchemaValidator.Validate on a rule with empty ensures array returns an error (Rule 4 enforcement)\n- SchemaValidator.Validate on a trigger with invalid kind returns an error (Rule 5 enforcement)\n- SchemaValidator.Validate on a snake_case entity name returns a naming pattern error\n- go test ./internal/schema/... passes with 0 failures","status":"closed","priority":0,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T23:15:59.605113Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.426207Z","closed_at":"2026-02-16T00:10:09.426207Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.6","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:15:59.606352Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.6","depends_on_id":"allium-992.3","type":"blocks","created_at":"2026-02-15T23:16:08.40265Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.6","depends_on_id":"allium-992.4","type":"blocks","created_at":"2026-02-15T23:16:08.778492Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.7","title":"Implement symbol table builder that collects all declared names from a spec","description":"A BuildSymbolTable function in internal/semantic/ traverses a parsed Spec AST and produces a SymbolTable mapping every declared name (entities, external entities, rules, triggers, actors, surfaces, config params, given bindings, enumerations, variants, use declarations) to its declaration location.\n\n## Inputs\n- **spec** (`ast.Spec`): Non-nil, deserialized from valid JSON -- Source: internal/ast/ LoadSpec output\n\n## Outputs\n- **symbol_table** (`Go source files`): SymbolTable with lookup methods for each symbol kind -- Dest: internal/semantic/symbols.go\n- **unit_tests** (`Go test file`): Tests for correct symbol collection -- Dest: internal/semantic/symbols_test.go\n\n## Constraints\n- Symbol table must be built in a single pass over the AST\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-symbol-table\",\"files_scope\":[\"internal/semantic/symbols.go\",\"internal/semantic/symbols_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"spec\",\"type\":\"ast.Spec\",\"constraints\":\"Non-nil, deserialized from valid JSON\",\"source\":\"internal/ast/ LoadSpec output\"}],\"outputs\":[{\"name\":\"symbol_table\",\"type\":\"Go source files\",\"constraints\":\"SymbolTable with lookup methods for each symbol kind\",\"destination\":\"internal/semantic/symbols.go\"},{\"name\":\"unit_tests\",\"type\":\"Go test file\",\"constraints\":\"Tests for correct symbol collection\",\"destination\":\"internal/semantic/symbols_test.go\"}]}}","acceptance_criteria":"- go build ./internal/semantic/... compiles without errors\n- BuildSymbolTable on password-auth.allium.json produces a SymbolTable with non-zero entity count\n- SymbolTable.LookupEntity('User') returns a non-nil entry for a spec containing entity User\n- SymbolTable.LookupEntity('NonExistent') returns nil\n- go test ./internal/semantic/... -run TestBuildSymbolTable passes with 0 failures","status":"closed","priority":0,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T23:16:00.117551Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.432074Z","closed_at":"2026-02-16T00:10:09.432074Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.7","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:16:00.118637Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.7","depends_on_id":"allium-992.4","type":"blocks","created_at":"2026-02-15T23:16:09.163612Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.7","depends_on_id":"allium-992.2","type":"blocks","created_at":"2026-02-15T23:16:09.560913Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.8","title":"Implement reference resolution semantic pass for Rules 1, 3, 22, 27, 28, 30, 31, 35","description":"A CheckReferences function verifies that every name reference in a Spec resolves to a declared symbol, reporting RULE-01, RULE-03, RULE-22, RULE-27, RULE-28, RULE-30, RULE-31, and RULE-35 errors for unresolved references.\n\n## Inputs\n- **spec** (`ast.Spec`): Parsed spec AST -- Source: internal/ast/\n- **symbols** (`SymbolTable`): Built from the same spec -- Source: internal/semantic/symbols.go\n\n## Outputs\n- **reference_checker** (`Go source file`): CheckReferences(spec, symbols) returns []Finding -- Dest: internal/semantic/references.go\n- **unit_tests** (`Go test file`): One test per rule ID -- Dest: internal/semantic/references_test.go\n\n## Constraints\n- Each finding must include the rule ID, severity error, and the unresolved name in the message\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-reference-resolution\",\"files_scope\":[\"internal/semantic/references.go\",\"internal/semantic/references_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"spec\",\"type\":\"ast.Spec\",\"constraints\":\"Parsed spec AST\",\"source\":\"internal/ast/\"},{\"name\":\"symbols\",\"type\":\"SymbolTable\",\"constraints\":\"Built from the same spec\",\"source\":\"internal/semantic/symbols.go\"}],\"outputs\":[{\"name\":\"reference_checker\",\"type\":\"Go source file\",\"constraints\":\"CheckReferences(spec, symbols) returns []Finding\",\"destination\":\"internal/semantic/references.go\"},{\"name\":\"unit_tests\",\"type\":\"Go test file\",\"constraints\":\"One test per rule ID\",\"destination\":\"internal/semantic/references_test.go\"}]}}","acceptance_criteria":"- CheckReferences on password-auth.allium.json returns zero findings\n- CheckReferences on a spec with entity_ref to undeclared 'FooBar' returns a finding with Rule='RULE-01' and Message containing 'FooBar'\n- CheckReferences on a spec with relationship target_entity 'NonExistent' returns a finding with Rule='RULE-03'\n- CheckReferences on a spec with undeclared given type returns Rule='RULE-22'\n- CheckReferences on a spec with undeclared config reference returns Rule='RULE-27'\n- CheckReferences on a spec with undeclared surface facing type returns Rule='RULE-28'\n- CheckReferences on a spec with undeclared provides trigger returns Rule='RULE-30'\n- CheckReferences on a spec with undeclared related surface returns Rule='RULE-31'\n- CheckReferences on a spec with undeclared use import returns Rule='RULE-35'\n- go test ./internal/semantic/... -run TestReference passes with 0 failures","status":"closed","priority":0,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T23:16:00.642829Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.436127Z","closed_at":"2026-02-16T00:10:09.436127Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.8","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:16:00.643961Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.8","depends_on_id":"allium-992.7","type":"blocks","created_at":"2026-02-15T23:16:09.965786Z","created_by":"Igor Ryabchuk"}]}
{"id":"allium-992.9","title":"Implement uniqueness enforcement pass for Rules 6, 23, 26","description":"A CheckUniqueness function detects duplicate given binding names (RULE-23), duplicate config parameter names (RULE-26), and incompatible trigger parameter signatures (RULE-06).\n\n## Inputs\n- **spec** (`ast.Spec`): Parsed spec AST -- Source: internal/ast/\n- **symbols** (`SymbolTable`): Built from the same spec -- Source: internal/semantic/symbols.go\n\n## Outputs\n- **uniqueness_checker** (`Go source file`): CheckUniqueness(spec, symbols) returns []Finding -- Dest: internal/semantic/uniqueness.go\n- **unit_tests** (`Go test file`): One test per rule and per happy path -- Dest: internal/semantic/uniqueness_test.go\n\n## Constraints\n- Must compare parameter counts and positional types for Rule 6\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-uniqueness-checks\",\"files_scope\":[\"internal/semantic/uniqueness.go\",\"internal/semantic/uniqueness_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"spec\",\"type\":\"ast.Spec\",\"constraints\":\"Parsed spec AST\",\"source\":\"internal/ast/\"},{\"name\":\"symbols\",\"type\":\"SymbolTable\",\"constraints\":\"Built from the same spec\",\"source\":\"internal/semantic/symbols.go\"}],\"outputs\":[{\"name\":\"uniqueness_checker\",\"type\":\"Go source file\",\"constraints\":\"CheckUniqueness(spec, symbols) returns []Finding\",\"destination\":\"internal/semantic/uniqueness.go\"},{\"name\":\"unit_tests\",\"type\":\"Go test file\",\"constraints\":\"One test per rule and per happy path\",\"destination\":\"internal/semantic/uniqueness_test.go\"}]}}","acceptance_criteria":"- CheckUniqueness on password-auth.allium.json returns zero findings\n- CheckUniqueness on a spec with two given bindings named 'current_user' returns a finding with Rule='RULE-23'\n- CheckUniqueness on a spec with two config parameters named 'max_retries' returns a finding with Rule='RULE-26'\n- CheckUniqueness on a spec with two rules triggered by 'UserSubmitsForm' with different parameter counts returns Rule='RULE-06'\n- CheckUniqueness on a spec with two rules triggered by 'UserSubmitsForm' with matching parameters returns zero RULE-06 findings\n- go test ./internal/semantic/... -run TestUniqueness passes with 0 failures","status":"closed","priority":0,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T23:16:01.186591Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-16T00:10:09.439872Z","closed_at":"2026-02-16T00:10:09.439872Z","close_reason":"Implementation complete - all tests passing","labels":["taskval-managed"],"dependencies":[{"issue_id":"allium-992.9","depends_on_id":"allium-992","type":"parent-child","created_at":"2026-02-15T23:16:01.188237Z","created_by":"Igor Ryabchuk"},{"issue_id":"allium-992.9","depends_on_id":"allium-992.7","type":"blocks","created_at":"2026-02-15T23:16:10.345496Z","created_by":"Igor Ryabchuk"}]}
